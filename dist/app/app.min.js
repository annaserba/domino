"use strict";const app=angular.module("App",["ngMaterial"]).config(function(o){o.theme("default").primaryPalette("teal",{default:"A400"}).accentPalette("orange")});let currentPosition=0;const positions=[{top:100,left:100},{top:135,left:205},{top:240,left:170},{top:205,left:65}],AddNewDomino=(o,t,e)=>{const n=[];var i=new fabric.Rect({top:o,left:t,width:70,height:70,strokeWidth:1,stroke:"gray",fill:"transparent"});return n.push(i),e%2==1&&n.push(new fabric.Circle({top:o+28,radius:6,fill:"rgb(29,233,182)",left:t+27,strokeWidth:3})),2<=e&&(n.push(new fabric.Circle({top:o+7,radius:6,fill:"rgb(29,233,182)",left:t+51,strokeWidth:3})),n.push(new fabric.Circle({top:o+50,radius:6,fill:"rgb(29,233,182)",left:t+5,strokeWidth:3}))),4<=e&&(n.push(new fabric.Circle({top:o+7,radius:6,fill:"rgb(29,233,182)",left:t+5,strokeWidth:3})),n.push(new fabric.Circle({top:o+50,radius:6,fill:"rgb(29,233,182)",left:t+51,strokeWidth:3}))),6===e&&(n.push(new fabric.Circle({top:o+28,radius:6,fill:"rgb(29,233,182)",left:t+5,strokeWidth:3})),n.push(new fabric.Circle({top:o+28,radius:6,fill:"rgb(29,233,182)",left:t+51,strokeWidth:3}))),new fabric.Group(n)},showAllDomino=(t,o)=>{const e=[];for(let o=0;o<7;o++)e.push({domino:AddNewDomino(100,100*o,o+1),position:"Top",point:o+1}),e.push({domino:AddNewDomino(170,100*o,o+1),position:"Bottom",point:o+1});for(let o=0;o<e.length;o++)t.add(e[o].domino);return e};app.controller("DominoController",e=>{const n=new fabric.StaticCanvas("currentDomino"),t=new fabric.StaticCanvas("newDomino");let i=[],r=AddNewDomino(100,100,1),a=AddNewDomino(170,100,1),l=new fabric.Group([r,a]);e.clearNewDomain=()=>{for(let o=0;o<i.length;o++)t.remove(i[o].domino);i=[]},fabric.util.addListener(n.lowerCanvasEl,"mousedown",o=>{0===i.length&&o.layerX>l.left&&o.layerY>l.top&&o.layerX<l.left+l.width&&o.layerY<l.top+l.height?i=showAllDomino(t,e):e.clearNewDomain()}),n.add(l),e.newDomino=()=>{0==i.length?i=showAllDomino(t,e):e.clearNewDomain()},e.left=()=>{currentPosition=currentPosition-1<0?3:currentPosition-1,l.animate("angle","-=90",{onChange:n.renderAll.bind(n),duration:e.duration}),l.animate("left",positions[currentPosition].left,{onChange:n.renderAll.bind(n),duration:e.duration}),l.animate("top",positions[currentPosition].top,{onChange:n.renderAll.bind(n),duration:e.duration})},e.right=()=>{currentPosition=(currentPosition+1)%4,l.animate("angle","+=90",{onChange:n.renderAll.bind(n),duration:e.duration}),l.animate("left",positions[currentPosition].left,{onChange:n.renderAll.bind(n),duration:e.duration}),l.animate("top",positions[currentPosition].top,{onChange:n.renderAll.bind(n),duration:e.duration})},e.scale=1,e.duration=500,e.$watch(()=>e.scale,(o,t)=>{l.animate("scaleX",o,{onChange:n.renderAll.bind(n),duration:e.duration}),l.animate("scaleY",o,{onChange:n.renderAll.bind(n),duration:e.duration})}),fabric.util.addListener(t.lowerCanvasEl,"mousedown",t=>{for(let o=0;o<i.length;o++)t.layerX>i[o].domino.left&&t.layerY>i[o].domino.top&&t.layerX<i[o].domino.left+i[o].domino.width&&t.layerY<i[o].domino.top+i[o].domino.height&&e.changeDomino({position:i[o].position,point:i[o].point})}),e.changeDomino=o=>{"Top"==o.position&&(n.remove(l),r=AddNewDomino(100,100,o.point),a.top=170,a.left=100,l=new fabric.Group([r,a]),n.add(l)),"Bottom"==o.position&&(n.remove(l),a=AddNewDomino(170,100,o.point),r.top=100,r.left=100,l=new fabric.Group([r,a]),n.add(l))}});